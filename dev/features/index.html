<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Features and usage · Plugins.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Plugins.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Plugins.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>Features and usage</a><ul class="internal"><li><a class="tocitem" href="#Good-work-starts-with-an-outline"><span>Good work starts with an outline</span></a></li><li><a class="tocitem" href="#Hooks"><span>Hooks</span></a></li><li><a class="tocitem" href="#State"><span>State</span></a></li><li><a class="tocitem" href="#Configuration-injection"><span>Configuration injection</span></a></li><li><a class="tocitem" href="#Dependency-injection"><span>Dependency injection</span></a></li><li><a class="tocitem" href="#Ad-hoc-Inter-plugin-communication"><span>Ad-hoc Inter-plugin communication</span></a></li><li><a class="tocitem" href="#Assembled-types:-Maintainable-runtime-metaprogramming"><span>Assembled types: Maintainable runtime metaprogramming</span></a></li></ul></li><li><a class="tocitem" href="../guide/">Guide</a></li><li><a class="tocitem" href="../repo/">Repo</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Features and usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Features and usage</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tisztamo/Plugins.jl/blob/master/docs/src/features.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Features-and-usage"><a class="docs-heading-anchor" href="#Features-and-usage">Features and usage</a><a id="Features-and-usage-1"></a><a class="docs-heading-anchor-permalink" href="#Features-and-usage" title="Permalink"></a></h1><h2 id="Good-work-starts-with-an-outline"><a class="docs-heading-anchor" href="#Good-work-starts-with-an-outline">Good work starts with an outline</a><a id="Good-work-starts-with-an-outline-1"></a><a class="docs-heading-anchor-permalink" href="#Good-work-starts-with-an-outline" title="Permalink"></a></h2><p>When using Plugins.jl, you split your system into two separated code domains: The <em><strong>base</strong></em> outlines the work to be done, and <em><strong>plugins</strong></em> fill out this outline with implementations. This pattern is widely used among large Julia packages<sup class="footnote-reference"><a id="citeref-pkgsplit" href="#footnote-pkgsplit">[pkgsplit]</a></sup>, because it helps coordinating developer work in a distributed fashion.</p><p>Plugins.jl extends this pattern with a coordination mechanism that allows multiple plugins to work together on the same task. This helps composing the system out of smaller, optional chunks, and also makes it easy to implement dynamic features like value-based message routing (aka dispatch on value) efficiently.</p><p>The coordination mechanism is very similar to how DOM event handlers work.</p><h2 id="Hooks"><a class="docs-heading-anchor" href="#Hooks">Hooks</a><a id="Hooks-1"></a><a class="docs-heading-anchor-permalink" href="#Hooks" title="Permalink"></a></h2><p>A plugin implements so-called hooks: functions that the system will call at specific points of its inner life. You can think of hooks as they were event handlers, where the event source is the &quot;base system&quot;. There are two types of hooks currently:</p><ul><li><p><em><strong>&quot;Lifecycle hooks&quot;</strong></em> are dynamically dispatched, and their results collected. Errors are also collected and do not interfere with other plugins.</p></li><li><p><em><strong>&quot;Normal hooks&quot;</strong></em> are designed for maximal runtime performance: When multiple plugins implement the same hook, their implementations will be merged together with simple glue code that allows any plugin to stop processing by simply returning true, similar to how DOM event handlers can stop event propagation. An error in a plugin also stops propagation.</p></li></ul><p>This categorization will very likely be changed in a breaking way to allow better tuning of compilation overhead.</p><h2 id="State"><a class="docs-heading-anchor" href="#State">State</a><a id="State-1"></a><a class="docs-heading-anchor-permalink" href="#State" title="Permalink"></a></h2><p>Plugins can have their own state, and they can also access a shared state provided by the base system.</p><h2 id="Configuration-injection"><a class="docs-heading-anchor" href="#Configuration-injection">Configuration injection</a><a id="Configuration-injection-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration-injection" title="Permalink"></a></h2><p>A &quot;global&quot; (per base system) configuration is passed to plugins during initialization, in the form of keyword arguments to the constructor. This means that plugins can specialize on the configuration, if performance requirements dictate that.</p><h2 id="Dependency-injection"><a class="docs-heading-anchor" href="#Dependency-injection">Dependency injection</a><a id="Dependency-injection-1"></a><a class="docs-heading-anchor-permalink" href="#Dependency-injection" title="Permalink"></a></h2><p>Plugins can declare other plugins as their <em><strong>mandantory dependencies</strong></em>. The system will analyse the dependency graph and initialize plugins accordingly. Just like configuration, dependencies are injected to the constructor.</p><p>Dependency declarations come in the form of types, e.g.:</p><pre><code class="language-julia hljs">Plugins.deps(::Type{Plugin3}) = [Plugin1, Plugin2]</code></pre><p>Concrete types are concrete dependencies, while abstract types are used as <em><strong>&quot;interfaces&quot;</strong></em>, meaning that any concrete subtype of the required abstract type can fulfill the dependency. The system will dynamically select implementations based on user configuration and specificity rules, allowing for example test mocking.</p><h2 id="Ad-hoc-Inter-plugin-communication"><a class="docs-heading-anchor" href="#Ad-hoc-Inter-plugin-communication">Ad-hoc Inter-plugin communication</a><a id="Ad-hoc-Inter-plugin-communication-1"></a><a class="docs-heading-anchor-permalink" href="#Ad-hoc-Inter-plugin-communication" title="Permalink"></a></h2><p>Plugins can (informally) publish a runtime API for other plugins to use. To use the API, it is enough to know the <em><strong>symbol</strong></em> of the used plugin instead of its (super)type, which allows lightweight duck-typed interoperability: The &quot;user&quot; plugin asks the system for the plugin with a specific symbol, and calls its API. Symbols are defined by the type of the plugin, and should be unique among the instantiated plugins in a system.</p><h2 id="Assembled-types:-Maintainable-runtime-metaprogramming"><a class="docs-heading-anchor" href="#Assembled-types:-Maintainable-runtime-metaprogramming">Assembled types: Maintainable runtime metaprogramming</a><a id="Assembled-types:-Maintainable-runtime-metaprogramming-1"></a><a class="docs-heading-anchor-permalink" href="#Assembled-types:-Maintainable-runtime-metaprogramming" title="Permalink"></a></h2><p>Additionally and optionally, the base system can define so-called assembled types. These are composite types that plugins will jointly assemble with every plugin allowed to delegate a single field.</p><p>This can help you with performance optimizations that normally would need <code>@generated</code> functions or other metaprograming. For example in the <a href="https://github.com/Circo-dev/CircoCore.jl/blob/0cedbb05b94a9e5ae8954d512afcf764bc8e400b/src/space.jl#L95">CircoCore.jl</a> actor system (the reference application of Plugins.jl), plugins can extend the message type with data used to optimize routing. This is implemented with zero runtime cost, and without any metaprogramming in the plugin itself.</p><p>The plugin just declares the field it wants to add to an abstract type, and the base system will be instantiated with a concrete subtype which was generated to contain the field. The plugin then can access the field in hooks at its will, while other plugins will not know about it.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-pkgsplit"><a class="tag is-link" href="#citeref-pkgsplit">pkgsplit</a>For example: Rackauckas, Chris &amp; Nie, Qing. (2017). <a href="https://www.researchgate.net/publication/317162482_DifferentialEquationsjl_-_A_Performant_and_Feature-Rich_Ecosystem_for_Solving_Differential_Equations_in_Julia">DifferentialEquations.jl – A Performant and Feature-Rich Ecosystem for Solving Differential Equations in Julia.</a> Journal of Open Research Software. 5. 10.5334/jors.151.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../guide/">Guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Thursday 21 April 2022 15:06">Thursday 21 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
